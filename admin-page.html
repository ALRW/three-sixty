<div id="admin-page" class="hidden">
  <section class="section">
    <div class="columns is-centered">
      <div id="team-details" class="column is-three-quarters"></div>
    </div>
  </section>
  <section class="section">
    <div class="columns is-centered">
      <div id="team-details" class="column is-half">
        <a id="add-team" class="button navbar-item is-primary is-large">Add Team</a>
      </div>
    </div>
  </section>
  <div class="modal">
    <div class="modal-background"></div>
    <div class="modal-content">
      <div class="box">
        <div class="field">
          <label class="label">Team Name</label>
          <div class="control">
            <input id="add-team-name" class="input" type="text" placeholder="e.g. The trombones">
          </div>
          <p class="help">Enter the name for your new team here</p>
        </div>
        <div class="field">
          <div class="control">
            <button id="add-team-submit" class="button is-link is-primary">Submit</button>
          </div>
        </div>
      </div>
    </div>
    <button class="modal-close is-large" aria-label="close"></button>
  </div>
</div>
<script>
  $('#add-team').click(function(e){
    e.preventDefault()
    $('.modal').addClass('is-active')
  })

  $('.modal-background').click(function(e){
    e.preventDefault()
    $('.modal').removeClass('is-active')
  })

  $('.modal-close').click(function(e){
    e.preventDefault()
    $('.modal').removeClass('is-active')
  })

  function renderTeams(teams) {
    const html = teams.reduce(function(result, teamName){
      return result + '\
      <div class="card">\
      <header class="card-header">\
      <p class="card-header-title">' + teamName + '</p>\
      </header>\
      <div class="card-content"></div>\
      <footer class="card-footer">\
      <a class="card-footer-item">Add Team Member</a>\
      <a class="card-footer-item">Start Feedback Round</a>\
      <a id="' + teamName + '-delete" class="card-footer-item">Delete Team</a>\
      </footer>\
      </div>'}, '')
    $('.modal').removeClass('is-active')
    $('#add-team-submit').removeClass('is-loading')
    $('#team-details').empty()
    $('#team-details').append(html)
    teams.forEach(function(teamName){
      $('#' + teamName + '-delete').click(function(e){
        e.preventDefault()
        google.script.run.withSuccessHandler(renderTeams).removeTeam(teamName)
      })

    })
  }

  $('#add-team-submit').click(function(e){
    e.preventDefault()
    $('#add-team-submit').addClass('is-loading')
    var name = $('#add-team-name').val()
    google.script.run.withSuccessHandler(renderTeams).addTeam(name)
  })
</script>
